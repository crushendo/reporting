{% extends 'base.html' %} 
{% block title %}About - {{ block.super }}{% endblock %} 

{% block header %}
<style>
    .wrapper {
        display: grid;

        /*  Define the size and number of columns in our grid. 
        The fr unit works similar to flex:
        fr columns will share the free space in the row in proportion to their value.
        We will have 2 columns - the second will be 3x the size of the first.  */
        grid-template-columns: 25vw 3fr;

        /*  Assign the grid areas we did earlier to specific places on the grid. 
            First row is all header.
            Second row is shared between main and sidebar.
            Last row is all footer.  */
        grid-template-areas: 
            "header header"
            "sidebar main"

        /*  The gutters between each grid cell will be 60 pixels. */
        grid-gap: 60px;
        grid-auto-rows: minmax(100px, auto);
        }
    header {
        grid-area: header;
        grid-column: 1 / 3;
        grid-row: 1
    }
    .main {
        grid-area: main;
        grid-column: 2;
        margin-right: 5vw;
        margin-left: 3vw;
    }
    .sidebar {
        grid-area: sidebar;
        grid-column: 1;
    }
    footer {
        grid-area: footer;
</style>

<style>
    table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }
    td, th {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #e6e6e6;
    }
    tr:hover {background-color: #d9e6f2}
}
</style>

<style>
    .checkContainer { border:2px solid #ccc; height: 100px; overflow-y: scroll; }
</style>

{% endblock %}
{% block content %}


{% csrf_token %}
<div class="wrapper"> 
    <header>
        <h3 style="text-align: center">Spray Trial Results</h3>
    </header>
    <aside class="sidebar">
        <h3 style="margin-top: 0; text-align: center">Filter</h3>
        <div>
            <h6>Name:</h6>
            <div class="checkContainer">
                {% for name in names_distinct %}
                    <input type="checkbox" value="{{name}}" onchange="nameFilter(this.value, this.checked);" checked /> {{ name }} <br />
                {% endfor %}
            </div>
            <h6>Field:</h6>
            <div class="checkContainer">
                {% for field in fields_distinct %}
                    <input type="checkbox" value="{{field}}" onchange="fieldFilter(this.value, this.checked);" checked  /> {{ field }} <br />
                {% endfor %}
            </div>
            <h6>Date:</h6>
            <div class="checkContainer">
                {% for date in dates_distinct %}
                    <input type="checkbox" value="{{date}}" onchange="dateFilter(this.value, this.checked);" checked  /> {{ date }} <br />
                {% endfor %}
            </div>
            <h6>Chemical:</h6>
            <div class="checkContainer">
                {% for chemical in chemicals_distinct %}
                    <input type="checkbox" value="{{chemical}}" onchange="chemicalFilter(this.value, this.checked);" checked  /> {{ chemical }} <br />
                {% endfor %}
            </div>
            <h6>Sprayer:</h6>
            <div class="checkContainer">
                {% for sprayer in sprayers_distinct %}
                    <input type="checkbox" value="{{sprayer}}" onchange="sprayerFilter(this.value, this.checked);" checked  /> {{ sprayer }} <br />
                {% endfor %}
            </div>
            <h6>Position:</h6>
            <div class="checkContainer">
                {% for position in position_distinct %}
                    <input type="checkbox" value="{{position}}" onchange="positionFilter(this.value, this.checked);" checked  /> {{ position }} <br />
                {% endfor %}
            </div>
        </div>
    </aside>
    <section class="main">
        <table id=myTable>
            <tr>
                <th>Name</th>
                <th>Field</th>
                <th>Date</th>
                <th>Chemical</th>
                <th>Sprayer</th>
                <th>Position</th>
                <th>Notes</th>
            </tr>
            <tbody>

            </tbody>
        </table>

    </section>
</div>

<script type="text/javascript">
    $(document).ready(function fillList(){
        //Then add all of the part pages
        var nameList = {{ name_json|safe }};
        var fieldList = {{ field_json|safe }};
        var dateList = {{ date_json|safe }}
        var chemicalList = {{ chemical_json|safe }};
        var sprayerList = {{ sprayer_json|safe }};
        var positionList = {{ position_json|safe }};
        var notesList = {{ notes_json|safe }};
        lengthIter = nameList.length;
        for(var yy = 0; yy < lengthIter; yy++){
            //var anchorElem = document.createElement("a");
            var nameIter = nameList[yy];
            var fieldIter = fieldList[yy];
            var dateIter = dateList[yy]
            var chemicalIter = chemicalList[yy];
            var sprayerIter = sprayerList[yy];
            var positionIter = positionList[yy];
            var notesIter = notesList[yy];
            // Insert a row in the table at row index 0
            var myTable = document.getElementById("myTable")
            var newRow = myTable.insertRow(myTable.rows.length);
            newRow.setAttribute('id', yy) 
            newRow.setAttribute('style', "display: ''") 
            // Insert a cell in the row at index 0
            var newCell1 = newRow.insertCell(0);
            var newCell2 = newRow.insertCell(1);
            var newCell3 = newRow.insertCell(2);
            var newCell4 = newRow.insertCell(3);
            var newCell5 = newRow.insertCell(4);
            var newCell6 = newRow.insertCell(5);
            var newCell7 = newRow.insertCell(6);
            // Append a text node to the cell
            var newName = document.createTextNode(nameIter);
            var newField = document.createTextNode(fieldIter);
            var newDate = document.createTextNode(dateIter);
            var newChem = document.createTextNode(chemicalIter);
            var newSprayer = document.createTextNode(sprayerIter);
            var newPosition = document.createTextNode(positionIter);
            var newNote = document.createTextNode(notesIter);
            newCell1.appendChild(newName);
            newCell2.appendChild(newField);
            newCell3.appendChild(newDate);
            newCell4.appendChild(newChem);
            newCell5.appendChild(newSprayer);
            newCell6.appendChild(newPosition);
            newCell7.appendChild(newNote);
        }
        for(var i = 0; i < yy; i++){
            checkOutList["row" + String(i)] = ["none"]
        }
    });
    if (window.addEventListener)
        window.addEventListener("load", fillList, false);
    else if (window.attachEvent)
        window.attachEvent("onload", fillList);
    else window.onload = fillList;

</script>

<script type="text/javascript">
    
    var checkOutList = {};
    
    function nameFilter(cb, checked) {
        var myTable = document.getElementById("myTable")
        for(var i = 0; i < lengthIter; i++){
            var currentRow = document.getElementById(i)
            var Cells = currentRow.getElementsByTagName("td");
            var cellContent = Cells[0].innerText;
            var status = currentRow.getAttribute("style")
            if(cellContent == cb){
                if(checked == false){
                    if(checkOutList["row" + String(i)].indexOf("name") <= 0){
                        checkOutList["row" + String(i)].push("name");
                        currentRow.setAttribute('style', "display: none")
                    }
                } else if(checked == true){
                    if(checkOutList["row" + String(i)].indexOf("name") >= 0){
                        var index = checkOutList["row" + String(i)].indexOf("name");
                        checkOutList["row" + String(i)].splice(index, 1)
                    }
                    if(checkOutList["row" + String(i)].length == 1){
                        currentRow.setAttribute('style', "display: ''")
                    }
                }
            }
        }
    }
    
    function fieldFilter(cb, checked) {
        var myTable = document.getElementById("myTable")
        for(var i = 0; i < lengthIter; i++){
            var currentRow = document.getElementById(i)
            var Cells = currentRow.getElementsByTagName("td");
            var cellContent = Cells[1].innerText;
            var status = currentRow.getAttribute("style")
            if(cellContent == cb){
                if(checked == false){
                    if(checkOutList["row" + String(i)].indexOf("field") <= 0){
                        checkOutList["row" + String(i)].push("field")
                        currentRow.setAttribute('style', "display: none")
                    }
                } else if(checked == true){
                    if(checkOutList["row" + String(i)].indexOf("field") >= 0){
                        var index = checkOutList["row" + String(i)].indexOf("field");
                        checkOutList["row" + String(i)].splice(index, 1)
                    }
                    if(checkOutList["row" + String(i)].length == 1){
                        currentRow.setAttribute('style', "display: ''")
                    }
                }
                
            }
        }
    }
    
    function dateFilter(cb, checked) {
        var myTable = document.getElementById("myTable")
        for(var i = 0; i < lengthIter; i++){
            var currentRow = document.getElementById(i)
            var Cells = currentRow.getElementsByTagName("td");
            var cellContent = Cells[2].innerText;
            var status = currentRow.getAttribute("style")
            if(cellContent == cb){
                if(checked == false){
                    if(checkOutList["row" + String(i)].indexOf("date") <= 0){
                        checkOutList["row" + String(i)].push("date");
                        currentRow.setAttribute('style', "display: none")
                    }
                } else if(checked == true){
                    if(checkOutList["row" + String(i)].indexOf("date") >= 0){
                        var index = checkOutList["row" + String(i)].indexOf("date");
                        checkOutList["row" + String(i)].splice(index, 1)
                    }
                    if(checkOutList["row" + String(i)].length == 1){
                        currentRow.setAttribute('style', "display: ''")
                    }
                }
            }
        }
    }
    
    function chemicalFilter(cb, checked) {
        var myTable = document.getElementById("myTable")
        for(var i = 0; i < lengthIter; i++){
            var currentRow = document.getElementById(i)
            var Cells = currentRow.getElementsByTagName("td");
            var cellContent = Cells[3].innerText;
            var status = currentRow.getAttribute("style")
            if(cellContent == cb){
                if(checked == false){
                    if(checkOutList["row" + String(i)].indexOf("chemical") <= 0){
                        checkOutList["row" + String(i)].push("chemical");
                        currentRow.setAttribute('style', "display: none")
                    }
                } else if(checked == true){
                    if(checkOutList["row" + String(i)].indexOf("chemical") >= 0){
                        var index = checkOutList["row" + String(i)].indexOf("chemical");
                        checkOutList["row" + String(i)].splice(index, 1)
                    }
                    if(checkOutList["row" + String(i)].length == 1){
                        currentRow.setAttribute('style', "display: ''")
                    }
                }
            }
        }
    }
    
    function sprayerFilter(cb, checked) {
        var myTable = document.getElementById("myTable")
        for(var i = 0; i < lengthIter; i++){
            var currentRow = document.getElementById(i)
            var Cells = currentRow.getElementsByTagName("td");
            var cellContent = Cells[4].innerText;
            var status = currentRow.getAttribute("style")
            if(cellContent == cb){
                if(checked == false){
                    if(checkOutList["row" + String(i)].indexOf("sprayer") <= 0){
                        checkOutList["row" + String(i)].push("sprayer");
                        currentRow.setAttribute('style', "display: none")
                    }
                } else if(checked == true){
                    if(checkOutList["row" + String(i)].indexOf("sprayer") >= 0){
                        var index = checkOutList["row" + String(i)].indexOf("sprayer");
                        checkOutList["row" + String(i)].splice(index, 1)
                    }
                    if(checkOutList["row" + String(i)].length == 1){
                        currentRow.setAttribute('style', "display: ''")
                    }
                }
            }
        }
    }
    
    function positionFilter(cb, checked) {
        var myTable = document.getElementById("myTable")
        for(var i = 0; i < lengthIter; i++){
            var currentRow = document.getElementById(i)
            var Cells = currentRow.getElementsByTagName("td");
            var cellContent = Cells[5].innerText;
            var status = currentRow.getAttribute("style")
            if(cellContent == cb){
                if(checked == false){
                    if(checkOutList["row" + String(i)].indexOf("position") <= 0){
                        checkOutList["row" + String(i)].push("position");
                        currentRow.setAttribute('style', "display: none")
                    }
                } else if(checked == true){
                    if(checkOutList["row" + String(i)].indexOf("position") >= 0){
                        var index = checkOutList["row" + String(i)].indexOf("position");
                        checkOutList["row" + String(i)].splice(index, 1)
                    }
                    if(checkOutList["row" + String(i)].length == 1){
                        currentRow.setAttribute('style', "display: ''")
                    }
                }
            }
        }
    }
</script>
{% endblock %}